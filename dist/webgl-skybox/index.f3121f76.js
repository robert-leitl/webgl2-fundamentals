!function(e,t,i,r,n){var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof s.parcelRequire9b6a&&s.parcelRequire9b6a,a=o.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(t,i){if(!a[t]){if(!e[t]){var r="function"==typeof s.parcelRequire9b6a&&s.parcelRequire9b6a;if(!i&&r)return r(t,!0);if(o)return o(t,!0);if(l&&"string"==typeof t)return l(t);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}h.resolve=function(i){var r=e[t][1][i];return null!=r?r:i},h.cache={};var c=a[t]=new u.Module(t);e[t][0].call(c.exports,h,c,c.exports,this)}return a[t].exports;function h(e){var t=h.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=a,u.parent=o,u.register=function(t,i){e[t]=[function(e,t){t.exports=i},{}]},Object.defineProperty(u,"root",{get:function(){return s.parcelRequire9b6a}}),s.parcelRequire9b6a=u;for(var c=0;c<t.length;c++)u(t[c]);var h=u(i);"object"==typeof exports&&"undefined"!=typeof module?module.exports=h:"function"==typeof define&&define.amd&&define((function(){return h}))}({OQAym:[function(e,t,i){e("./helpers/bundle-manifest").register(JSON.parse('{"fUEoC":"index.f3121f76.js","9io3L":"posx.28f4b747.jpg","7v880":"negx.ba3120bc.jpg","VsYcq":"posy.ab3d8fa5.jpg","gtLvT":"negy.6959de6a.jpg","fRegG":"posz.aa426500.jpg","6tnEg":"negz.2804daa2.jpg","9LU3i":"index.ba31ca7d.js","9TbUc":"index.5ed48ace.js","2G3CA":"index.15f73c8a.js","eRuGw":"index.3eb9ea76.js"}'))},{"./helpers/bundle-manifest":"gSiLw"}],gSiLw:[function(e,t,i){"use strict";var r={};t.exports.register=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)r[t[i]]=e[t[i]]},t.exports.resolve=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}},{}],"70cZU":[function(e,t,i){e("tweakpane");var r,n,s=e("./webgl-skybox");window.addEventListener("load",(function(){var e,t=document.body.querySelector("#c");r=new s.WebGLSkybox(t,e,(function(e){e.run()}))})),window.addEventListener("resize",(function(){r&&(n&&clearTimeout(n),n=setTimeout((function(){n=null,r.resize()}),300))}))},{tweakpane:"53J2X","./webgl-skybox":"gdb14"}],gdb14:[function(e,t,i){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(i),r.export(i,"WebGLSkybox",(function(){return y}));var n=e("@swc/helpers"),s=e("../math/m4"),o=e("chroma-js"),a=r.interopDefault(o),l=e("twgl.js"),u=e("./shader/fragment.glsl"),c=r.interopDefault(u),h=e("./shader/vertex.glsl"),f=r.interopDefault(h),d=e("./shader/skybox-fragment.glsl"),m=r.interopDefault(d),v=e("./shader/skybox-vertex.glsl"),p=r.interopDefault(v),_=new WeakSet,b=new WeakSet,g=new WeakSet,E=new WeakSet,x=new WeakSet,T=new WeakSet,w=new WeakSet,M=new WeakSet,R=new WeakSet,y=function(){"use strict";function e(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n.classCallCheck(this,e),n.defineProperty(this,"oninit",void 0),U.set(this,{writable:!0,value:0}),A.set(this,{writable:!0,value:!1}),_.add(this),b.add(this),g.add(this),E.add(this),x.add(this),T.add(this),w.add(this),M.add(this),R.add(this),this.canvas=t,this.pane=i,this.oninit=r,n.classPrivateMethodGet(this,g,L).call(this)}return n.createClass(e,[{key:"resize",value:function(){l.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),n.classPrivateMethodGet(this,x,I).call(this)}},{key:"run",value:function(){this.lastFrameTime=performance.now(),n.classPrivateMethodGet(this,_,P).call(this,this.lastFrameTime)}},{key:"destroy",value:function(){n.classPrivateFieldSet(this,A,!0)}},{key:"degToRad",value:function(e){return e*Math.PI/180}},{key:"rand",value:function(e,t){return void 0===t&&(t=e,e=0),e+Math.random()*(t-e)}},{key:"randInt",value:function(e){return Math.floor(Math.random()*e)}}]),e}(),U=new WeakMap,A=new WeakMap;function P(e){var t=this,i=e-this.lastFrameTime;this.lastFrameTime=e,n.classPrivateFieldGet(this,A)||(this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.DEPTH_TEST),n.classPrivateMethodGet(this,b,S).call(this),this.rotation[1]+=i/3e4*Math.PI*2,this.rotation[2]+=i/2e4*Math.PI*2,n.classPrivateMethodGet(this,M,B).call(this),requestAnimationFrame((function(e){return n.classPrivateMethodGet(t,_,P).call(t,e)})))}function S(){this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.useProgram(this.program),l.setUniforms(this.uniformSetters,this.uniformsThatAreTheSameForAllObjects),this.gl.bindVertexArray(this.objectVertexArrayObject),this.uniformsThatAreComputedForEachObject.u_world=this.modelMatrix,s.m4.transpose(s.m4.inverse(this.modelMatrix),this.uniformsThatAreComputedForEachObject.u_worldInverseTranspose),l.setUniforms(this.uniformSetters,this.uniformsThatAreComputedForEachObject),l.setUniforms(this.uniformSetters,this.material1Uniforms),this.gl.drawElements(this.gl.TRIANGLES,this.objectBuffers.numElements,this.gl.UNSIGNED_SHORT,0),this.gl.depthFunc(this.gl.LEQUAL),this.gl.useProgram(this.skyboxProgram),l.setUniforms(this.skyboxUniformSetters,{u_cubeMap:this.cubeMapTexture,u_viewProjectionInverse:this.viewProjectionInverse}),this.gl.bindVertexArray(this.skyboxVertexArrayObject),this.gl.drawElements(this.gl.TRIANGLES,this.skyboxBuffers.numElements,this.gl.UNSIGNED_SHORT,0)}function L(){this.gl=this.canvas.getContext("webgl2");var e=this.gl;if(!this.gl)throw new Error("No WebGL 2 context!");l.setAttributePrefix("a_"),this.program=l.createProgramFromSources(e,[f.default,c.default]),this.uniformSetters=l.createUniformSetters(e,this.program);var t=l.createAttributeSetters(e,this.program);this.skyboxProgram=l.createProgramFromSources(e,[p.default,m.default]),this.skyboxUniformSetters=l.createUniformSetters(e,this.skyboxProgram);var i=l.createAttributeSetters(e,this.skyboxProgram);this.objectBuffers=l.primitives.createTorusBuffers(this.gl,20,10,64,64);var r={a_position:{buffer:this.objectBuffers.position,numComponents:3},a_normal:{buffer:this.objectBuffers.normal,numComponents:3},a_texcoord:{buffer:this.objectBuffers.texcoord,numComponents:2}};this.objectVertexArrayObject=l.createVAOAndSetAttributes(e,t,r,this.objectBuffers.indices),this.skyboxBuffers=l.primitives.createXYQuadBuffers(this.gl);var o={a_position:{buffer:this.skyboxBuffers.position,numComponents:2}};this.skyboxVertexArrayObject=l.createVAOAndSetAttributes(e,i,o,this.skyboxBuffers.indices);var u=e.createTexture();e.bindTexture(e.TEXTURE_2D,u);var h=e.LUMINANCE,d=e.LUMINANCE,v=e.UNSIGNED_BYTE,_=new Uint8Array([255,128,255,128,255,128,255,128,128,255,128,255,128,255,128,255,255,128,255,128,255,128,255,128,128,255,128,255,128,255,128,255,255,128,255,128,255,128,255,128,128,255,128,255,128,255,128,255,255,128,255,128,255,128,255,128,128,255,128,255,128,255,128,255]);e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,h,8,8,0,d,v,_),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n.classPrivateMethodGet(this,E,C).call(this,this.gl),this.material1Uniforms={u_colorMult:a.default.hsv(0,0,1).gl(),u_ambient:[.4,.4,.41,1],u_diffuse:u,u_specular:[1,1,1,1],u_shininess:10,u_specularFactor:.9},this.origin=[0,0,0],this.translation=[0,0,0],this.scale=[1,1,1],this.rotation=[0,0,0],n.classPrivateMethodGet(this,M,B).call(this),this.projectionMatrix=s.m4.identity(),this.viewMatrix=s.m4.identity(),this.cameraMatrix=s.m4.identity(),this.viewProjectionInverse=s.m4.identity(),this.planeModelMatrix=s.m4.translation(0,-15,0),n.classPrivateMethodGet(this,x,I).call(this),this.cameraRotationY=0,n.classPrivateMethodGet(this,T,j).call(this),this.uniformsThatAreTheSameForAllObjects={u_projection:this.projectionMatrix,u_view:this.viewMatrix,u_lightWorldPos:[-100,100,100],u_viewInverse:this.cameraMatrix,u_lightColor:[1,1,1,1],u_cubeMap:this.cubeMapTexture},this.uniformsThatAreComputedForEachObject={u_world:s.m4.identity(),u_worldInverseTranspose:s.m4.identity()},this.resize(),n.classPrivateMethodGet(this,R,G).call(this),this.oninit&&this.oninit(this)}function C(t){var i=this;this.envMapInfos=[{target:t.TEXTURE_CUBE_MAP_POSITIVE_X,url:new URL(e("29ef4ec476dfec18"))},{target:t.TEXTURE_CUBE_MAP_NEGATIVE_X,url:new URL(e("99554e0c9a4c19da"))},{target:t.TEXTURE_CUBE_MAP_POSITIVE_Y,url:new URL(e("afef7ab02c8049c4"))},{target:t.TEXTURE_CUBE_MAP_NEGATIVE_Y,url:new URL(e("81fed6f774d7f188"))},{target:t.TEXTURE_CUBE_MAP_POSITIVE_Z,url:new URL(e("cd6d91b3423c0a19"))},{target:t.TEXTURE_CUBE_MAP_NEGATIVE_Z,url:new URL(e("151b4a886dd2ac71"))}],this.cubeMapTexture=t.createTexture(),t.bindTexture(t.TEXTURE_CUBE_MAP,this.cubeMapTexture),this.envMapInfos.forEach((function(e){var r=i,n=e.target,s=e.url,o=t.RGBA,a=t.UNSIGNED_BYTE,l=t.RGBA;t.texImage2D(n,0,o,2048,2048,0,l,a,null);var u=new Image;u.src=s,u.addEventListener("load",(function(){t.bindTexture(t.TEXTURE_CUBE_MAP,r.cubeMapTexture),t.texImage2D(n,0,o,l,a,u),t.generateMipmap(t.TEXTURE_CUBE_MAP)}))})),t.generateMipmap(t.TEXTURE_CUBE_MAP),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR)}function I(){var e=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,t=Math.PI/180*75;s.m4.perspective(t,e,1,2e3,this.projectionMatrix),n.classPrivateMethodGet(this,w,F).call(this)}function j(){s.m4.yRotation(this.cameraRotationY,this.cameraMatrix),s.m4.translate(this.cameraMatrix,0,0,100,this.cameraMatrix),s.m4.inverse(this.cameraMatrix,this.viewMatrix),n.classPrivateMethodGet(this,w,F).call(this)}function F(){var e=n.toConsumableArray(this.viewMatrix);e[12]=0,e[13]=0,e[14]=0;var t=s.m4.multiply(this.projectionMatrix,e);s.m4.inverse(t,this.viewProjectionInverse)}function B(){this.modelMatrix=s.m4.translation(this.translation[0],this.translation[1],this.translation[2]),this.modelMatrix=s.m4.xRotate(this.modelMatrix,this.rotation[0]),this.modelMatrix=s.m4.yRotate(this.modelMatrix,this.rotation[1]),this.modelMatrix=s.m4.zRotate(this.modelMatrix,this.rotation[2]),this.modelMatrix=s.m4.scale(this.modelMatrix,this.scale[0],this.scale[1],this.scale[2]),this.modelMatrix=s.m4.translate(this.modelMatrix,-this.origin[0],-this.origin[1],-this.origin[2])}function G(){if(this.pane){var e=this;this.pane.addBlade({view:"slider",label:"camera RY",min:0,max:2*Math.PI,value:0}).on("change",(function(t){e.cameraRotationY=t.value,n.classPrivateMethodGet(e,T,j).call(e)}))}}},{"@swc/helpers":"2CIBz","../math/m4":"d0U9A","chroma-js":"lAOe9","twgl.js":"bpC7N","./shader/fragment.glsl":"66FhO","./shader/vertex.glsl":"dOYsC","./shader/skybox-fragment.glsl":"iqVII","./shader/skybox-vertex.glsl":"crIGR","29ef4ec476dfec18":"27puY","99554e0c9a4c19da":"dQarL",afef7ab02c8049c4:"9H9m4","81fed6f774d7f188":"5Ed7N",cd6d91b3423c0a19:"5ZHq6","151b4a886dd2ac71":"1YweB","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],"66FhO":[function(e,t,i){t.exports="#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n \nin vec4 v_position;\nin vec2 v_texCoord;\nin vec3 v_normal;\nin vec3 v_surfaceToLight;\nin vec3 v_surfaceToView;\n \nuniform vec4 u_lightColor;\nuniform vec4 u_ambient;\nuniform sampler2D u_diffuse;\nuniform samplerCube u_cubeMap;\nuniform vec4 u_specular;\nuniform float u_shininess;\nuniform float u_specularFactor;\nuniform vec4 u_colorMult;\n \nout vec4 outColor;\n \nvec4 lit(float l ,float h, float m) {\n  return vec4(1.0,\n              max(l, 0.0),\n              (l > 0.0) ? pow(max(0.0, h), m) : 0.0,\n              1.0);\n}\n \nvoid main() {\n    vec4 diffuseColor = min(vec4(1.), texture(u_diffuse, fract(v_texCoord * vec2(2.,1.))) * u_colorMult + vec4(0.1));\n    vec3 a_normal = normalize(v_normal);\n    vec3 surfaceToLight = normalize(v_surfaceToLight);\n    vec3 surfaceToView = normalize(v_surfaceToView);\n    vec3 halfVector = normalize(surfaceToLight + surfaceToView);\n    vec4 litR = lit(dot(a_normal, surfaceToLight), dot(a_normal, halfVector), u_shininess);\n\n    vec3 r = dot(a_normal, surfaceToView) * a_normal * 2. - surfaceToView;\n    vec4 env = texture(u_cubeMap, r);\n\n    diffuseColor *= env;\n\n    outColor = vec4((u_lightColor * (diffuseColor * litR.y + diffuseColor * u_ambient + u_specular * litR.y * litR.z * u_specularFactor)).rgb, diffuseColor.a);\n}"},{}],dOYsC:[function(e,t,i){t.exports="#version 300 es\n#define GLSLIFY 1\n \nuniform mat4 u_projection;\nuniform mat4 u_view;\nuniform vec3 u_lightWorldPos;\nuniform mat4 u_world;\nuniform mat4 u_viewInverse;\nuniform mat4 u_worldInverseTranspose;\n \nin vec4 a_position;\nin vec3 a_normal;\nin vec2 a_texcoord;\n \nout vec4 v_position;\nout vec2 v_texCoord;\nout vec3 v_normal;\nout vec3 v_surfaceToLight;\nout vec3 v_surfaceToView;\n \nvoid main() {\n    vec4 worldPosition = u_world * a_position;\n    v_texCoord = a_texcoord;\n    v_position = u_projection * u_view * worldPosition;\n    v_normal = (u_worldInverseTranspose * vec4(a_normal, 0)).xyz;\n    v_surfaceToLight = u_lightWorldPos - worldPosition.xyz;\n    v_surfaceToView = (u_viewInverse[3] - worldPosition).xyz;\n    gl_Position = v_position;\n}"},{}],iqVII:[function(e,t,i){t.exports="#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nin vec4 v_position;\n \nuniform mat4 u_viewProjectionInverse;\nuniform samplerCube u_cubeMap;\n \nout vec4 outColor;\n\nvoid main() {\n    vec4 d = u_viewProjectionInverse * v_position;\n    outColor = texture(u_cubeMap, normalize(d.xyz / d.w));\n}"},{}],crIGR:[function(e,t,i){t.exports="#version 300 es\n#define GLSLIFY 1\n \nin vec4 a_position;\n\nout vec4 v_position;\n \nvoid main() {\n    v_position = a_position;\n    gl_Position = vec4(a_position.xy, 1., 1.);\n}"},{}],"27puY":[function(e,t,i){t.exports=e("./helpers/bundle-url").getBundleURL("fUEoC")+"../"+e("./helpers/bundle-manifest").resolve("9io3L")},{"./helpers/bundle-url":"a2ypy","./helpers/bundle-manifest":"gSiLw"}],a2ypy:[function(e,t,i){"use strict";var r={};function n(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}i.getBundleURL=function(e){var t=r[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return n(e[2])}return"/"}(),r[e]=t),t},i.getBaseURL=n,i.getOrigin=function(e){var t=(""+e).match(/(https?|file|ftp):\/\/[^/]+/);if(!t)throw new Error("Origin not found");return t[0]}},{}],dQarL:[function(e,t,i){t.exports=e("./helpers/bundle-url").getBundleURL("fUEoC")+"../"+e("./helpers/bundle-manifest").resolve("7v880")},{"./helpers/bundle-url":"a2ypy","./helpers/bundle-manifest":"gSiLw"}],"9H9m4":[function(e,t,i){t.exports=e("./helpers/bundle-url").getBundleURL("fUEoC")+"../"+e("./helpers/bundle-manifest").resolve("VsYcq")},{"./helpers/bundle-url":"a2ypy","./helpers/bundle-manifest":"gSiLw"}],"5Ed7N":[function(e,t,i){t.exports=e("./helpers/bundle-url").getBundleURL("fUEoC")+"../"+e("./helpers/bundle-manifest").resolve("gtLvT")},{"./helpers/bundle-url":"a2ypy","./helpers/bundle-manifest":"gSiLw"}],"5ZHq6":[function(e,t,i){t.exports=e("./helpers/bundle-url").getBundleURL("fUEoC")+"../"+e("./helpers/bundle-manifest").resolve("fRegG")},{"./helpers/bundle-url":"a2ypy","./helpers/bundle-manifest":"gSiLw"}],"1YweB":[function(e,t,i){t.exports=e("./helpers/bundle-url").getBundleURL("fUEoC")+"../"+e("./helpers/bundle-manifest").resolve("6tnEg")},{"./helpers/bundle-url":"a2ypy","./helpers/bundle-manifest":"gSiLw"}]},["OQAym","70cZU"],"70cZU");
//# sourceMappingURL=index.f3121f76.js.map
