!function(t,e,i,s,n){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof r.parcelRequire9b6a&&r.parcelRequire9b6a,o=a.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function h(e,i){if(!o[e]){if(!t[e]){var s="function"==typeof r.parcelRequire9b6a&&r.parcelRequire9b6a;if(!i&&s)return s(e,!0);if(a)return a(e,!0);if(l&&"string"==typeof e)return l(e);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}c.resolve=function(i){var s=t[e][1][i];return null!=s?s:i},c.cache={};var u=o[e]=new h.Module(e);t[e][0].call(u.exports,c,u,u.exports,this)}return o[e].exports;function c(t){var e=c.resolve(t);return!1===e?{}:h(e)}}h.isParcelRequire=!0,h.Module=function(t){this.id=t,this.bundle=h,this.exports={}},h.modules=t,h.cache=o,h.parent=a,h.register=function(e,i){t[e]=[function(t,e){e.exports=i},{}]},Object.defineProperty(h,"root",{get:function(){return r.parcelRequire9b6a}}),r.parcelRequire9b6a=h;for(var u=0;u<e.length;u++)h(e[u]);var c=h(i);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd&&define((function(){return c}))}({g5e2b:[function(t,e,i){t("tweakpane");var s,n,r=t("./webgl-gpgpu-data-texture");window.addEventListener("load",(function(){var t,e=document.body.querySelector("#c");s=new r.WebGLGPGPUDataTexture(e,t,(function(t){t.run()}))})),window.addEventListener("resize",(function(){s&&(n&&clearTimeout(n),n=setTimeout((function(){n=null,s.resize()}),300))}))},{tweakpane:"53J2X","./webgl-gpgpu-data-texture":"f6BHH"}],f6BHH:[function(t,e,i){var s=t("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(i),s.export(i,"WebGLGPGPUDataTexture",(function(){return j}));var n=t("@swc/helpers"),r=t("twgl.js"),a=t("./shader/compute-particle-position.frag"),o=s.interopDefault(a),l=t("./shader/compute-particle-position.vert"),h=s.interopDefault(l),u=t("./shader/deposit.frag"),c=s.interopDefault(u),f=t("./shader/deposit.vert"),d=s.interopDefault(f),g=t("./shader/draw.frag"),v=s.interopDefault(g),_=t("./shader/draw.vert"),m=s.interopDefault(_),p=t("./shader/decay.frag"),P=s.interopDefault(p),x=t("./shader/decay.vert"),T=s.interopDefault(x),A=t("./shader/diffuse-h.frag"),R=s.interopDefault(A),E=t("./shader/diffuse-h.vert"),L=s.interopDefault(E),w=t("./shader/diffuse-v.frag"),b=s.interopDefault(w),S=t("./shader/diffuse-v.vert"),M=s.interopDefault(S),F=t("./shader/copy.frag"),y=s.interopDefault(F),D=t("./shader/copy.vert"),U=s.interopDefault(D),G=new WeakSet,B=new WeakSet,C=new WeakSet,I=new WeakSet,O=new WeakSet,V=new WeakSet,k=new WeakSet,N=new WeakSet,X=new WeakSet,W=new WeakSet,z=new WeakSet,Y=new WeakSet,q=new WeakSet,H=new WeakSet,j=function(){"use strict";function t(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n.classCallCheck(this,t),n.defineProperty(this,"oninit",void 0),n.defineProperty(this,"diffuse",1),n.defineProperty(this,"decay",.97),n.defineProperty(this,"randomStrength",8),n.defineProperty(this,"sensorDist",16),n.defineProperty(this,"sensorAngle",Math.PI/4),n.defineProperty(this,"sensorSize",25),n.defineProperty(this,"velocity",.9),n.defineProperty(this,"steeringStrength",.98),K.set(this,{writable:!0,value:0}),J.set(this,{writable:!0,value:0}),Q.set(this,{writable:!0,value:!1}),n.defineProperty(this,"camera",{rotation:0,position:[0,0,1],matrix:r.m4.identity()}),G.add(this),B.add(this),C.add(this),Z.set(this,{writable:!0,value:function(t,e){return void 0===e&&(e=t,t=0),Math.random()*(e-t)+t}}),I.add(this),O.add(this),V.add(this),k.add(this),N.add(this),X.add(this),W.add(this),z.add(this),Y.add(this),q.add(this),H.add(this),this.canvas=e,this.pane=i,this.oninit=s,n.classPrivateMethodGet(this,B,tt).call(this)}return n.createClass(t,[{key:"resize",value:function(){r.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),n.classPrivateMethodGet(this,C,et).call(this),n.classPrivateMethodGet(this,Y,ut).call(this)}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this;n.classPrivateFieldSet(this,J,t-n.classPrivateFieldGet(this,K)),n.classPrivateFieldSet(this,K,t),n.classPrivateFieldGet(this,Q)||(this.computeUniforms.u_deltaTime=n.classPrivateFieldGet(this,J),n.classPrivateMethodGet(this,G,$).call(this),requestAnimationFrame((function(t){return e.run(t)})))}},{key:"destroy",value:function(){n.classPrivateFieldSet(this,Q,!0)}}]),t}(),K=new WeakMap,J=new WeakMap,Q=new WeakMap,Z=new WeakMap;function $(){this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.RASTERIZER_DISCARD),this.gl.useProgram(this.computeParticleProgram),this.gl.bindVertexArray(this.currentRenderState.computeVAO),this.gl.uniform1f(this.computeParticleLocations.u_deltaTime,this.computeUniforms.u_deltaTime),this.gl.uniform2i(this.computeParticleLocations.u_resolution,this.gl.canvas.width,this.gl.canvas.height),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture1),this.gl.uniform1i(this.computeParticleLocations.u_dataTexture,0),this.gl.uniform1f(this.computeParticleLocations.u_randomStrength,this.randomStrength),this.gl.uniform1f(this.computeParticleLocations.u_sensorDist,this.sensorDist),this.gl.uniform1f(this.computeParticleLocations.u_sensorAngle,this.sensorAngle),this.gl.uniform1f(this.computeParticleLocations.u_velocity,this.velocity),this.gl.uniform1f(this.computeParticleLocations.u_steeringStrength,this.steeringStrength),this.gl.uniform1f(this.computeParticleLocations.u_sensorSize,this.sensorSize),this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,this.currentRenderState.transformFeedback),this.gl.beginTransformFeedback(this.gl.POINTS),this.gl.drawArrays(this.gl.POINTS,0,this.NUM_PARTICLES),this.gl.endTransformFeedback(),this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,null),this.gl.disable(this.gl.RASTERIZER_DISCARD),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,this.fbo1,this.gl.canvas.width,this.gl.canvas.height),this.gl.useProgram(this.copyProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture2),this.gl.uniform1i(this.copyLocations.u_texture,0),this.gl.bindVertexArray(this.quadVAO),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.useProgram(this.depositProgram),this.gl.uniform2i(this.depositLocations.u_resolution,this.gl.canvas.width,this.gl.canvas.height),this.gl.bindVertexArray(this.currentRenderState.drawVAO),this.gl.drawArrays(this.gl.POINTS,0,this.NUM_PARTICLES),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,null,this.gl.canvas.width,this.gl.canvas.height),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,this.fbo2,this.gl.canvas.width,this.gl.canvas.height),this.gl.useProgram(this.diffuseHProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture1),this.gl.uniform1i(this.diffuseHLocations.u_texture,0),this.gl.uniform1f(this.diffuseHLocations.u_diffuse,this.diffuse),this.gl.bindVertexArray(this.quadVAO),this.gl.drawArrays(this.gl.TRIANGLES,0,6),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,null,this.gl.canvas.width,this.gl.canvas.height),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,this.fbo1,this.gl.canvas.width,this.gl.canvas.height),this.gl.useProgram(this.diffuseVProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture2),this.gl.uniform1i(this.diffuseVLocations.u_texture,0),this.gl.uniform1f(this.diffuseVLocations.u_diffuse,this.diffuse),this.gl.bindVertexArray(this.quadVAO),this.gl.drawArrays(this.gl.TRIANGLES,0,6),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,null,this.gl.canvas.width,this.gl.canvas.height),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,this.fbo2,this.gl.canvas.width,this.gl.canvas.height),this.gl.useProgram(this.decayProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture1),this.gl.uniform1i(this.decayLocations.u_texture,0),this.gl.uniform1f(this.decayLocations.u_decay,this.decay),this.gl.bindVertexArray(this.quadVAO),this.gl.drawArrays(this.gl.TRIANGLES,0,6),n.classPrivateMethodGet(this,V,nt).call(this,this.gl,null,this.gl.canvas.width,this.gl.canvas.height),this.gl.useProgram(this.drawProgram),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.bindVertexArray(this.quadVAO),this.gl.uniformMatrix4fv(this.drawLocations.u_worldMatrix,!1,this.drawUniforms.u_worldMatrix),this.gl.uniformMatrix4fv(this.drawLocations.u_viewMatrix,!1,this.drawUniforms.u_viewMatrix),this.gl.uniformMatrix4fv(this.drawLocations.u_projectionMatrix,!1,this.drawUniforms.u_projectionMatrix),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture2),this.gl.uniform1i(this.drawLocations.u_texture,0),this.gl.drawArrays(this.gl.TRIANGLES,0,6);var t=this.currentRenderState;this.currentRenderState=this.nextRenderState,this.nextRenderState=t}function tt(){var t=this;if(this.gl=this.canvas.getContext("webgl2",{antialias:!0}),!this.gl)throw new Error("No WebGL 2 context!");if(this.gl.getExtension("EXT_color_buffer_float")){this.computeParticleProgram=n.classPrivateMethodGet(this,W,lt).call(this,this.gl,[h.default,o.default],["t_newPosition","t_newAngle"]),this.depositProgram=n.classPrivateMethodGet(this,W,lt).call(this,this.gl,[d.default,c.default]),this.drawProgram=n.classPrivateMethodGet(this,W,lt).call(this,this.gl,[m.default,v.default],null,{a_position:0,a_uv:1}),this.decayProgram=n.classPrivateMethodGet(this,W,lt).call(this,this.gl,[T.default,P.default],null,{a_position:0,a_uv:1}),this.diffuseHProgram=n.classPrivateMethodGet(this,W,lt).call(this,this.gl,[L.default,R.default],null,{a_position:0,a_uv:1}),this.diffuseVProgram=n.classPrivateMethodGet(this,W,lt).call(this,this.gl,[M.default,b.default],null,{a_position:0,a_uv:1}),this.copyProgram=n.classPrivateMethodGet(this,W,lt).call(this,this.gl,[U.default,y.default],null,{a_position:0,a_uv:1}),this.computeParticleLocations={a_oldPosition:this.gl.getAttribLocation(this.computeParticleProgram,"a_oldPosition"),a_oldAngle:this.gl.getAttribLocation(this.computeParticleProgram,"a_oldAngle"),u_deltaTime:this.gl.getUniformLocation(this.computeParticleProgram,"u_deltaTime"),u_resolution:this.gl.getUniformLocation(this.computeParticleProgram,"u_resolution"),u_trailsTexture:this.gl.getUniformLocation(this.computeParticleProgram,"u_trailsTexture"),u_randomStrength:this.gl.getUniformLocation(this.computeParticleProgram,"u_randomStrength"),u_sensorDist:this.gl.getUniformLocation(this.computeParticleProgram,"u_sensorDist"),u_sensorAngle:this.gl.getUniformLocation(this.computeParticleProgram,"u_sensorAngle"),u_velocity:this.gl.getUniformLocation(this.computeParticleProgram,"u_velocity"),u_steeringStrength:this.gl.getUniformLocation(this.computeParticleProgram,"u_steeringStrength"),u_sensorSize:this.gl.getUniformLocation(this.computeParticleProgram,"u_sensorSize")},this.depositLocations={u_resolution:this.gl.getUniformLocation(this.depositProgram,"u_resolution"),a_position:this.gl.getAttribLocation(this.depositProgram,"a_position")},this.decayLocations={a_position:this.gl.getAttribLocation(this.decayProgram,"a_position"),a_uv:this.gl.getAttribLocation(this.decayProgram,"a_uv"),u_texture:this.gl.getUniformLocation(this.decayProgram,"u_texture"),u_decay:this.gl.getUniformLocation(this.decayProgram,"u_decay")},this.diffuseHLocations={a_position:this.gl.getAttribLocation(this.diffuseHProgram,"a_position"),a_uv:this.gl.getAttribLocation(this.diffuseHProgram,"a_uv"),u_texture:this.gl.getUniformLocation(this.diffuseHProgram,"u_texture"),u_diffuse:this.gl.getUniformLocation(this.diffuseHProgram,"u_diffuse")},this.diffuseVLocations={a_position:this.gl.getAttribLocation(this.diffuseVProgram,"a_position"),a_uv:this.gl.getAttribLocation(this.diffuseVProgram,"a_uv"),u_texture:this.gl.getUniformLocation(this.diffuseVProgram,"u_texture"),u_diffuse:this.gl.getUniformLocation(this.diffuseVProgram,"u_diffuse")},this.copyLocations={a_position:this.gl.getAttribLocation(this.copyProgram,"a_position"),a_uv:this.gl.getAttribLocation(this.copyProgram,"a_uv"),u_texture:this.gl.getUniformLocation(this.copyProgram,"u_texture")},this.drawLocations={a_position:this.gl.getAttribLocation(this.drawProgram,"a_position"),a_uv:this.gl.getAttribLocation(this.drawProgram,"a_uv"),u_worldMatrix:this.gl.getUniformLocation(this.drawProgram,"u_worldMatrix"),u_viewMatrix:this.gl.getUniformLocation(this.drawProgram,"u_viewMatrix"),u_projectionMatrix:this.gl.getUniformLocation(this.drawProgram,"u_projectionMatrix"),u_texture:this.gl.getUniformLocation(this.drawProgram,"u_texture")},this.NUM_PARTICLES=1e5;var e=new Float32Array(Array(this.NUM_PARTICLES).fill(0).map((function(t){return Math.random()*Math.PI*2}))),i=new Float32Array(Array(this.NUM_PARTICLES).fill(0).map((function(i,s){return[-Math.cos(e[s])*Math.random()*200+t.canvas.clientWidth/2,-Math.sin(e[s])*Math.random()*200+t.canvas.clientHeight/2]})).flat());this.position1Buffer=n.classPrivateMethodGet(this,N,at).call(this,this.gl,i,this.gl.DYNAMIC_DRAW),this.position2Buffer=n.classPrivateMethodGet(this,N,at).call(this,this.gl,i,this.gl.DYNAMIC_DRAW),this.angles1Buffer=n.classPrivateMethodGet(this,N,at).call(this,this.gl,e,this.gl.DYNAMIC_DRAW),this.angles2Buffer=n.classPrivateMethodGet(this,N,at).call(this,this.gl,e,this.gl.DYNAMIC_DRAW),this.compute1VAO=n.classPrivateMethodGet(this,k,rt).call(this,this.gl,[[this.position1Buffer,this.computeParticleLocations.a_oldPosition,2],[this.angles1Buffer,this.computeParticleLocations.a_oldAngle,1]]),this.compute2VAO=n.classPrivateMethodGet(this,k,rt).call(this,this.gl,[[this.position2Buffer,this.computeParticleLocations.a_oldPosition,2],[this.angles2Buffer,this.computeParticleLocations.a_oldAngle,1]]),this.draw1VAO=n.classPrivateMethodGet(this,k,rt).call(this,this.gl,[[this.position1Buffer,this.depositLocations.a_position,2]]),this.draw2VAO=n.classPrivateMethodGet(this,k,rt).call(this,this.gl,[[this.position2Buffer,this.depositLocations.a_position,2]]),this.pos1TF=n.classPrivateMethodGet(this,I,it).call(this,this.gl,[this.position1Buffer,this.angles1Buffer]),this.pos2TF=n.classPrivateMethodGet(this,I,it).call(this,this.gl,[this.position2Buffer,this.angles2Buffer]),this.dataTexture1=n.classPrivateMethodGet(this,O,st).call(this,this.gl),this.dataTexture2=n.classPrivateMethodGet(this,O,st).call(this,this.gl),this.fbo1=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbo1),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.dataTexture1,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.fbo2=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbo2),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.dataTexture2,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.quadPositionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.quadPositionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),this.gl.STATIC_DRAW),this.quadUVBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.quadUVBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this.gl.STATIC_DRAW),this.quadVAO=n.classPrivateMethodGet(this,k,rt).call(this,this.gl,[[this.quadPositionBuffer,this.drawLocations.a_position,2],[this.quadUVBuffer,this.drawLocations.a_uv,2]]),this.computeUniforms={u_deltaTime:0},this.drawUniforms={u_worldMatrix:r.m4.identity(),u_viewMatrix:r.m4.identity(),u_projectionMatrix:r.m4.identity()},this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.TRANSFORM_FEEDBACK_BUFFER,null),this.currentRenderState={computeVAO:this.compute1VAO,transformFeedback:this.pos2TF,drawVAO:this.draw2VAO},this.nextRenderState={computeVAO:this.compute2VAO,transformFeedback:this.pos1TF,drawVAO:this.draw1VAO},this.resize(),n.classPrivateMethodGet(this,z,ht).call(this),n.classPrivateMethodGet(this,Y,ut).call(this),n.classPrivateMethodGet(this,q,ct).call(this),this.oninit&&this.oninit(this)}else alert("need EXT_color_buffer_float")}function et(){var t=this.gl.canvas.width,e=this.gl.canvas.height;this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.R32F,t,e,0,this.gl.RED,this.gl.FLOAT,new Float32Array(t*e)),this.gl.bindTexture(this.gl.TEXTURE_2D,this.dataTexture2),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.R32F,t,e,0,this.gl.RED,this.gl.FLOAT,new Float32Array(t*e))}function it(t,e){var i=t.createTransformFeedback();return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,i),e.forEach((function(e,i){t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,e)})),i}function st(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),e}function nt(t,e,i,s){t.bindFramebuffer(t.FRAMEBUFFER,e),t.viewport(0,0,i,s)}function rt(t,e){var i=t.createVertexArray();t.bindVertexArray(i);var s=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(s=(o=l.next()).done);s=!0){var h=n.slicedToArray(o.value,3),u=h[0],c=h[1],f=h[2];t.bindBuffer(t.ARRAY_BUFFER,u),t.enableVertexAttribArray(c),t.vertexAttribPointer(c,f,t.FLOAT,!1,0,0)}}catch(t){r=!0,a=t}finally{try{s||null==l.return||l.return()}finally{if(r)throw a}}return i}function at(t,e,i){var s=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,e,i),s}function ot(t,e,i){var s=t.createShader(e);if(t.shaderSource(s,i),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS))return s;console.error(t.getShaderInfoLog(s)),t.deleteShader(s)}function lt(t,e,i,s){var r=this,a=t.createProgram();if([t.VERTEX_SHADER,t.FRAGMENT_SHADER].forEach((function(i,s){var o=n.classPrivateMethodGet(r,X,ot).call(r,t,i,e[s]);t.attachShader(a,o)})),i&&t.transformFeedbackVaryings(a,i,t.SEPARATE_ATTRIBS),s)for(var o in s)t.bindAttribLocation(a,s[o],o);if(t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS))return a;console.error(t.getProgramInfoLog(a)),t.deleteProgram(a)}function ht(){r.m4.lookAt(this.camera.position,[0,0,0],[0,1,0],this.camera.matrix),r.m4.inverse(this.camera.matrix,this.drawUniforms.u_viewMatrix)}function ut(){r.m4.ortho(-1,1,-1,1,0,2,this.drawUniforms.u_projectionMatrix)}function ct(){this.pane&&(n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"decay",.8,.99999),n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"diffuse",0,1),n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"randomStrength",.1,10),n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"sensorDist",3,50),n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"sensorSize",1,30),n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"sensorAngle",0,Math.PI/2),n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"velocity",.05,2),n.classPrivateMethodGet(this,H,ft).call(this,this.pane,"steeringStrength",.2,1))}function ft(t,e,i,s){var r=this;t.addBlade({view:"slider",label:e,min:i,max:s,value:this[e]}).on("change",(function(t){r[e]=t.value,n.classPrivateMethodGet(r,z,ht).call(r)}))}},{"@swc/helpers":"2CIBz","twgl.js":"bpC7N","./shader/compute-particle-position.frag":"31QRG","./shader/compute-particle-position.vert":"cECgk","./shader/deposit.frag":"g2Q65","./shader/deposit.vert":"lohBr","./shader/draw.frag":"03gct","./shader/draw.vert":"fJxxf","./shader/decay.frag":"jPiJe","./shader/decay.vert":"4Lcsn","./shader/diffuse-h.frag":"4IAmE","./shader/diffuse-h.vert":"cOw5b","./shader/diffuse-v.frag":"ihgtN","./shader/diffuse-v.vert":"lisCf","./shader/copy.frag":"7tpuu","./shader/copy.vert":"k5Mg5","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],"31QRG":[function(t,e,i){e.exports="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nvoid main() {}\n"},{}],cECgk:[function(t,e,i){e.exports="#version 300 es\n#define GLSLIFY 1\n\nuniform float u_deltaTime;\nuniform ivec2 u_resolution;\nuniform sampler2D u_dataTexture;\nuniform float u_randomStrength;\nuniform float u_sensorDist;\nuniform float u_sensorAngle;\nuniform float u_velocity;\nuniform float u_steeringStrength;\nuniform float u_sensorSize;\n\nin vec2 a_oldPosition;\nin float a_oldAngle;\n\nout vec2 t_newPosition;\nout float t_newAngle;\n\nconst float PI = 3.14159265359;\n\nfloat hash(float n) { return fract(sin(n) * 1e4); }\nfloat hash(vec2 p) { return fract(1e4 * sin(17.0 * p.x + p.y * 0.1) * (0.1 + abs(sin(p.y * 13.0 + p.x)))); }\n\nfloat noise(vec2 x) {\n\tvec2 i = floor(x);\n\tvec2 f = fract(x);\n\tfloat a = hash(i);\n\tfloat b = hash(i + vec2(1.0, 0.0));\n\tfloat c = hash(i + vec2(0.0, 1.0));\n\tfloat d = hash(i + vec2(1.0, 1.0));\n\tvec2 u = f * f * (3.0 - 2.0 * f);\n\treturn mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;\n}\n\nfloat getSensorData(vec2 origin, float angle, float dist, float sensorSize) {\n    vec2 off = vec2(cos(angle), sin(angle)) * dist;\n    vec2 size = vec2(textureSize(u_dataTexture, 0));\n    vec2 sensorUV = (origin + off) / size;\n    vec4 s = textureLod(u_dataTexture, sensorUV, sensorSize);\n    return s.r;\n}\n\nvoid main() {\n    vec2 pos = a_oldPosition;\n    float angle = a_oldAngle;\n    float velocity = u_velocity;\n\n    // get random value between -1 and 1\n    float n = noise(pos * u_deltaTime * 10.);\n    n *= u_randomStrength;\n\n    \n    float left = getSensorData(pos, angle + u_sensorAngle, u_sensorDist, u_sensorSize);\n    float middle = getSensorData(pos, angle, u_sensorDist, u_sensorSize);\n    float right = getSensorData(pos, angle - u_sensorAngle, u_sensorDist, u_sensorSize);\n\n    if (middle > left && middle > right) {\n      angle += 0.0; \n    } else if (middle < left && middle < right) {\n      angle += (n * 2. - 1.) * u_steeringStrength * u_deltaTime;\n    } else if (right > left) {\n      angle -= u_steeringStrength * u_deltaTime;\n    } else if (left > right) {\n      angle += u_steeringStrength * u_deltaTime;\n    }\n\n    vec2 direction = vec2(cos(angle), sin(angle));\n    vec2 resolution = vec2(u_resolution);\n    vec2 centerPos = pos - (resolution * .5 - 1.);\n    vec2 centerDirection = normalize(centerPos);\n    float damping = smoothstep(0.25, 1., length(centerPos) / min(resolution.x, resolution.y));\n    float returnStrength = max(0., dot(centerDirection, direction)) * damping;\n    // find the return angle with the cross product\n    angle += sign(centerDirection.x * direction.y - centerDirection.y * direction.x) * returnStrength;\n    direction = vec2(cos(angle), sin(angle));\n    \n    t_newPosition = pos + velocity * direction * u_deltaTime;\n    t_newPosition = mod(t_newPosition, vec2(u_resolution));\n    t_newAngle = angle;\n}\n"},{}],g2Q65:[function(t,e,i){e.exports="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nout vec4 outColor;\n\nvoid main() {\n    outColor = vec4(1.);\n}\n"},{}],lohBr:[function(t,e,i){e.exports="#version 300 es\n#define GLSLIFY 1\n\nuniform ivec2 u_resolution;\n\nin vec2 a_position;\n\nvoid main() {\n    vec4 pos = vec4(a_position, 0., 1.) / vec4(u_resolution, 1., 1.);\n    pos = pos * 2. - 1.;\n    gl_Position = pos;\n    gl_PointSize = 1.;\n}\n"},{}],"03gct":[function(t,e,i){e.exports="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_texture;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvec3 palette( in float t, in vec3 a, in vec3 b, in vec3 c, in vec3 d )\n{\n    return a + b*cos( 6.28318*(c*t+d) );\n}\n\nvoid main() {\n    float value = texture(u_texture, v_uv).r;\n    vec3 color = palette(value, vec3(0.5, 0.5, 0.5),\tvec3(0.5, 0.5, 0.5), vec3(2.0, 1.0, 0.0), vec3(0.50, 0.20, 0.25));\n    //outColor = vec4(color, 1.);\n    outColor = vec4(vec3(value), 1.) * 1.;\n}\n"},{}],fJxxf:[function(t,e,i){e.exports="#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = u_projectionMatrix * u_viewMatrix * u_worldMatrix * vec4(a_position, 0., 1.);\n}\n"},{}],jPiJe:[function(t,e,i){e.exports="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_texture;\nuniform float u_decay;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvoid main() {\n    outColor = texture(u_texture, v_uv) * u_decay;\n}"},{}],"4Lcsn":[function(t,e,i){e.exports="#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"},{}],"4IAmE":[function(t,e,i){e.exports="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_texture;\nuniform float u_diffuse;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvoid main() {\n    vec2 texResolution = vec2(textureSize(u_texture, 0));\n    vec4 sum;\n    ivec2 samplePos = ivec2(v_uv * vec2(texResolution));\n    for (int o = -1; o <= 1; ++o) {\n        ivec2 sampleOff = ivec2(o, 0);\n        sum += texelFetch(u_texture, samplePos + sampleOff, 0);\n    }\n\n    vec4 blurResult = sum / 3.0;\n    vec4 orgColor = texture(u_texture, v_uv);\n    outColor = mix(orgColor, blurResult, u_diffuse);\n}"},{}],cOw5b:[function(t,e,i){e.exports="#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"},{}],ihgtN:[function(t,e,i){e.exports="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_texture;\nuniform float u_diffuse;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvoid main() {\n    vec2 texResolution = vec2(textureSize(u_texture, 0));\n    vec4 sum;\n    ivec2 samplePos = ivec2(v_uv * vec2(texResolution));\n    for (int o = -1; o <= 1; ++o) {\n        ivec2 sampleOff = ivec2(0., o);\n        sum += texelFetch(u_texture, samplePos + sampleOff, 0);\n    }\n\n    vec4 blurResult = sum / 3.0;\n    vec4 orgColor = texture(u_texture, v_uv);\n    outColor = mix(orgColor, blurResult, u_diffuse);\n}"},{}],lisCf:[function(t,e,i){e.exports="#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"},{}],"7tpuu":[function(t,e,i){e.exports="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_texture;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvoid main() {\n    outColor = texture(u_texture, v_uv);\n}"},{}],k5Mg5:[function(t,e,i){e.exports="#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"},{}]},["g5e2b"],"g5e2b");
//# sourceMappingURL=index.6338a8a2.js.map
